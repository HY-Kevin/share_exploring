k=16;
Fs = 1000000;%采样频率1MHz x=(randn(1, 200)+3) / 6 * 10;
len = 10000;%不能太小，否则在这边做验证时，滤波输出的FFT的频率不对
t = (0:len-1)/Fs;
% y = sin(2*pi*1000000*t)+sin(2*pi*2700000*t)+sin(2*pi*2500000*t)+cos(2*pi*3000000*t)+sin(2*pi*1800000*t)+sin(2*pi*3800000*t)+sin(2*pi*3200000*t)+sin(2*pi*4000000*t)+sin(2*pi*2800000*t)+(randn(1, 1000))/6;%并掺入随机噪声
% y = sin(2*pi*8000*t)+cos(2*pi*30000*t)+sin(2*pi*180000*t)+sin(2*pi*3800000*t)+sin(2*pi*3200000*t)+sin(2*pi*4000000*t)+sin(2*pi*2800000*t)+(randn(1, 10000))/10;%并掺入随机噪声
y = 2*sin(2*pi*3000*t)+sin(2*pi*8000*t)+sin(2*pi*12000*t)+sin(2*pi*15000*t)+(randn(1, 10000))/6;
% y = sin(2*pi*1000000*t)+sin(2*pi*3000000*t)+sin(2*pi*2500000*t);
plot(t,y);
y_ad = y/max(abs(y));
q_ad=round(y_ad*(2^(k-1)-1));%进行16bit量化，配合后续的FPGA实现
%将信号导入文件
fid=fopen('./signal_in.txt','w');
for i = 1:len
    if q_ad(i) >= 0
        fprintf(fid,'%X\n', q_ad(i));
    else
        fprintf(fid,'%X\n', q_ad(i)+2^k);
    end
end
fclose(fid);

%滤波下看看效果 - 滤波系数需要在量化处理前下个断点然后贴过来
% coeff =[-0.000670725257353326,-0.000792999076599835,0.000266038144856742,0.00242748622170168,0.00356423810419241,0.000966388550376318,-0.00522328831077981,-0.00991137450195772,-0.00608921327755592,0.00763839393725974,0.0216996619828801,0.0200433963479112,-0.00544243614741472,-0.0413925444277523,-0.0546325709158592,-0.0132631456339571,0.0859668556998134,0.206328460214929,0.288733383188963,0.288733383188963,0.206328460214929,0.0859668556998134,-0.0132631456339571,-0.0546325709158592,-0.0413925444277523,-0.00544243614741472,0.0200433963479112,0.0216996619828801,0.00763839393725974,-0.00608921327755592,-0.00991137450195772,-0.00522328831077981,0.000966388550376318,0.00356423810419241,0.00242748622170168,0.000266038144856742,-0.000792999076599835,-0.000670725257353326];
% coeff = [-0.000330979071680577,-5.50142418715581e-05,-5.83899233005294e-05,-6.10229386550884e-05,-6.28692390453495e-05,-6.38127740985618e-05,-6.38301129789967e-05,-6.28021442815492e-05,-6.06775372852928e-05,-5.72627411565912e-05,-5.24464439620379e-05,-4.60401338563882e-05,-3.81418191955563e-05,-2.89292280511830e-05,-1.87620889562028e-05,-6.09581720487578e-06,7.22475490810853e-06,2.21013480837777e-05,3.82510341149398e-05,5.55755553661594e-05,7.39730418405623e-05,9.32648674840754e-05,0.000113253209649522,0.000133747099984571,0.000154551235335883,0.000175478687368925,0.000196218684986828,0.000216428578703830,0.000235803526478832,0.000254366995067474,0.000271309827906738,0.000286654204484094,0.000299950722476214,0.000310906571276894,0.000319234192899831,0.000324616570972084,0.000326761188423756,0.000325403386669524,0.000320318482618341,0.000311316443630082,0.000298178717625201,0.000280735133725278,0.000258908777237841,0.000232748538042406,0.000202033044726100,0.000166989788645684,0.000127616922549539,8.40965046267350e-05,3.66497970938765e-05,-1.44729876149084e-05,-6.89493749203878e-05,-0.000126395144867116,-0.000186353183086686,-0.000248312819331449,-0.000311749035058021,-0.000376066023505732,-0.000440588239604649,-0.000504589905816540,-0.000567450331217877,-0.000628300176764747,-0.000686438549549766,-0.000741037621814470,-0.000791291260561520,-0.000836413796266533,-0.000875615638874054,-0.000908127506326589,-0.000933196723645475,-0.000950117565262102,-0.000958257697775645,-0.000957020586836878,-0.000945858638529490,-0.000924312674656017,-0.000892071954406799,-0.000848792994773484,-0.000794369411400013,-0.000728706958097283,-0.000651863609577927,-0.000564028415914168,-0.000465501135750361,-0.000356713223900428,-0.000238214625252847,-0.000110697102663998,2.50026051317746e-05,0.000167940366930488,0.000317054851343991,0.000471150554561052,0.000628893402663163,0.000788918322326569,0.000949669790887297,0.00110959095672868,0.00126701221577417,0.00142020247708101,0.00156739985822859,0.00170680834903375,0.00183663116017318,0.00195506571937285,0.00206032608809790,0.00215068772686709,0.00222448949800568,0.00228014037457413,0.00231614349452056,0.00233116407932595,0.00232394170126557,0.00229344375824166,0.00223877160669430,0.00215922379918702,0.00205431841496439,0.00192378929438465,0.00176761664964416,0.00158601485946296,0.00137945152527064,0.00114867115297797,0.000894683547688149,0.000618760837352780,0.000322446487029593,7.57448008542315e-06,-0.000323800816663752,-0.000669310804538530,-0.00102638103878341,-0.00139219188794126,-0.00176369485816498,-0.00213764669075882,-0.00251060854090728,-0.00287899309701910,-0.00323907396970748,-0.00358700234130781,-0.00391884960102205,-0.00423063693045761,-0.00451835909965688,-0.00477800891497694,-0.00500564795761089,-0.00519736699465807,-0.00534940352951754,-0.00545812279534534,-0.00552005945497251,-0.00553196513200722,-0.00549081841924653,-0.00539388319828135,-0.00523872043153096,-0.00502321193792878,-0.00474559862783399,-0.00440450161429388,-0.00399893835201259,-0.00352834088440054,-0.00299259062074630,-0.00239198009572580,-0.00172729171109297,-0.000999751255436570,-0.000211044732818302,0.000636672718963415,0.00154080514577147,0.00249829415300354,0.00350565392261346,0.00455898594509807,0.00565399003088759,0.00678599047534967,0.00794996555515041,0.00914057458937624,0.0103521819527585,0.0115789267418649,0.0128147031423601,0.0140532496947238,0.0152881714621887,0.0165129762963842,0.0177211434140225,0.0189061328826368,0.0200614597515458,0.0211807328212187,0.0222576939670331,0.0232862666317556,0.0242606003466536,0.0251751101920315,0.0260245156006313,0.0268039009418671,0.0275087064363513,0.0281348062908467,0.0286785173523470,0.0291366237725679,0.0295064248285956,0.0297857150662799,0.0299728361676950,0.0300666765770978,0.0300666765770978,0.0299728361676950,0.0297857150662799,0.0295064248285956,0.0291366237725679,0.0286785173523470,0.0281348062908467,0.0275087064363513,0.0268039009418671,0.0260245156006313,0.0251751101920315,0.0242606003466536,0.0232862666317556,0.0222576939670331,0.0211807328212187,0.0200614597515458,0.0189061328826368,0.0177211434140225,0.0165129762963842,0.0152881714621887,0.0140532496947238,0.0128147031423601,0.0115789267418649,0.0103521819527585,0.00914057458937624,0.00794996555515041,0.00678599047534967,0.00565399003088759,0.00455898594509807,0.00350565392261346,0.00249829415300354,0.00154080514577147,0.000636672718963415,-0.000211044732818302,-0.000999751255436570,-0.00172729171109297,-0.00239198009572580,-0.00299259062074630,-0.00352834088440054,-0.00399893835201259,-0.00440450161429388,-0.00474559862783399,-0.00502321193792878,-0.00523872043153096,-0.00539388319828135,-0.00549081841924653,-0.00553196513200722,-0.00552005945497251,-0.00545812279534534,-0.00534940352951754,-0.00519736699465807,-0.00500564795761089,-0.00477800891497694,-0.00451835909965688,-0.00423063693045761,-0.00391884960102205,-0.00358700234130781,-0.00323907396970748,-0.00287899309701910,-0.00251060854090728,-0.00213764669075882,-0.00176369485816498,-0.00139219188794126,-0.00102638103878341,-0.000669310804538530,-0.000323800816663752,7.57448008542315e-06,0.000322446487029593,0.000618760837352780,0.000894683547688149,0.00114867115297797,0.00137945152527064,0.00158601485946296,0.00176761664964416,0.00192378929438465,0.00205431841496439,0.00215922379918702,0.00223877160669430,0.00229344375824166,0.00232394170126557,0.00233116407932595,0.00231614349452056,0.00228014037457413,0.00222448949800568,0.00215068772686709,0.00206032608809790,0.00195506571937285,0.00183663116017318,0.00170680834903375,0.00156739985822859,0.00142020247708101,0.00126701221577417,0.00110959095672868,0.000949669790887297,0.000788918322326569,0.000628893402663163,0.000471150554561052,0.000317054851343991,0.000167940366930488,2.50026051317746e-05,-0.000110697102663998,-0.000238214625252847,-0.000356713223900428,-0.000465501135750361,-0.000564028415914168,-0.000651863609577927,-0.000728706958097283,-0.000794369411400013,-0.000848792994773484,-0.000892071954406799,-0.000924312674656017,-0.000945858638529490,-0.000957020586836878,-0.000958257697775645,-0.000950117565262102,-0.000933196723645475,-0.000908127506326589,-0.000875615638874054,-0.000836413796266533,-0.000791291260561520,-0.000741037621814470,-0.000686438549549766,-0.000628300176764747,-0.000567450331217877,-0.000504589905816540,-0.000440588239604649,-0.000376066023505732,-0.000311749035058021,-0.000248312819331449,-0.000186353183086686,-0.000126395144867116,-6.89493749203878e-05,-1.44729876149084e-05,3.66497970938765e-05,8.40965046267350e-05,0.000127616922549539,0.000166989788645684,0.000202033044726100,0.000232748538042406,0.000258908777237841,0.000280735133725278,0.000298178717625201,0.000311316443630082,0.000320318482618341,0.000325403386669524,0.000326761188423756,0.000324616570972084,0.000319234192899831,0.000310906571276894,0.000299950722476214,0.000286654204484094,0.000271309827906738,0.000254366995067474,0.000235803526478832,0.000216428578703830,0.000196218684986828,0.000175478687368925,0.000154551235335883,0.000133747099984571,0.000113253209649522,9.32648674840754e-05,7.39730418405623e-05,5.55755553661594e-05,3.82510341149398e-05,2.21013480837777e-05,7.22475490810853e-06,-6.09581720487578e-06,-1.87620889562028e-05,-2.89292280511830e-05,-3.81418191955563e-05,-4.60401338563882e-05,-5.24464439620379e-05,-5.72627411565912e-05,-6.06775372852928e-05,-6.28021442815492e-05,-6.38301129789967e-05,-6.38127740985618e-05,-6.28692390453495e-05,-6.10229386550884e-05,-5.83899233005294e-05,-5.50142418715581e-05,-0.000330979071680577];
coeff = [0.000267238437462116,-4.36517792826240e-05,-4.06525714850800e-05,-3.79654554769724e-05,-3.58188158280655e-05,-3.38858849806385e-05,-3.24107450011364e-05,-3.10681776493996e-05,-3.01204898794731e-05,-2.92364739015668e-05,-2.87014631601664e-05,-2.81680961031351e-05,-2.79559318273690e-05,-2.76812923161268e-05,-2.77276100019451e-05,-2.76167617103940e-05,-2.79542660979663e-05,-2.76963035394188e-05,-2.84292656714884e-05,-2.86210968408115e-05,-2.86244650050044e-05,-2.90063996178404e-05,-2.94726793379448e-05,-2.99368114356206e-05,-3.03194861182596e-05,-3.06257870229791e-05,-3.09208215243265e-05,-3.11967600503739e-05,-3.15111384850524e-05,-3.18066997073650e-05,-3.21141968935246e-05,-3.23706381287010e-05,-3.25851098683830e-05,-3.27575807815398e-05,-3.28102810915339e-05,-3.28616540537839e-05,-3.28977575438944e-05,-3.26531473451666e-05,-3.26285630419364e-05,-3.24192630895979e-05,-3.22161589098308e-05,-3.18208393945121e-05,-3.14934240378381e-05,-3.10247447096997e-05,-3.05948202970010e-05,-2.99747646936382e-05,-2.93565158682240e-05,-2.85458855825865e-05,-2.77571004008799e-05,-2.67924023081827e-05,-2.58660253703977e-05,-2.47539731073938e-05,-2.36553239376072e-05,-2.24266664881490e-05,-2.10994881718715e-05,-1.97118097525056e-05,-1.82974039525518e-05,-1.67118087215978e-05,-1.51292639740536e-05,-1.34348151496517e-05,-1.17446328046574e-05,-9.89831269055974e-06,-8.03535017709244e-06,-6.03001997275351e-06,-4.03228598087500e-06,-1.90305074656828e-06,2.23960834993262e-07,2.48939253003056e-06,4.74371681025143e-06,7.13865499159586e-06,9.46943965838447e-06,1.19677705208975e-05,1.43887846917702e-05,1.69250740323752e-05,1.94572385780843e-05,2.20837053049331e-05,2.46574527886935e-05,2.73250687867486e-05,2.99542649311928e-05,3.26568723594888e-05,3.52903596441715e-05,3.79816107130622e-05,4.06115404030407e-05,4.33012064262814e-05,4.59225791208800e-05,4.85746624036225e-05,5.11520557343697e-05,5.37327605371150e-05,5.62469136642102e-05,5.87692470064259e-05,6.11757983263581e-05,6.36162650168458e-05,6.59220003793916e-05,6.82171350429117e-05,7.03858633206040e-05,7.25511529784107e-05,7.45674954007085e-05,7.65507052026812e-05,7.83750628099677e-05,8.01631440421784e-05,8.17790082944034e-05,8.33397368232544e-05,8.47115036484625e-05,8.60297099343899e-05,8.71546944405953e-05,8.82155315002777e-05,8.90830665279796e-05,8.98407434422261e-05,9.04134830877461e-05,9.08729604982330e-05,9.11176091960672e-05,9.12564806176701e-05,9.11831839420458e-05,9.09809718682166e-05,9.05494677793848e-05,8.99922030391493e-05,8.92100837125149e-05,8.82916271297840e-05,8.71370485888772e-05,8.58406272224750e-05,8.43112766407217e-05,8.26398743691200e-05,8.07231101667877e-05,7.86724446681090e-05,7.63625048014221e-05,7.39303409232333e-05,7.12524932888259e-05,6.84296901578563e-05,6.53686049825955e-05,6.21711020078835e-05,5.87297128765240e-05,5.51551200316416e-05,5.13562501502233e-05,4.74341579936882e-05,4.32856275209139e-05,3.90144660773525e-05,3.45293165485052e-05,2.99340432126425e-05,2.51364658156456e-05,2.02281483366621e-05,1.51374698983752e-05,9.94502532257170e-06,4.58495136195912e-06,-8.51656796130459e-07,-6.45841102863223e-06,-1.21198044431343e-05,-1.79228936593184e-05,-2.37704834556051e-05,-2.97453242813735e-05,-3.57404177106019e-05,-4.18455036996932e-05,-4.79583368280765e-05,-5.41595901893067e-05,-6.03383815347067e-05,-6.65825658764451e-05,-7.27858565630876e-05,-7.90410980914675e-05,-8.52279610848206e-05,-9.14401945504774e-05,-9.75654670895193e-05,-0.000103682012991266,-0.000109697997071951,-0.000115676372372865,-0.000121519272343622,-0.000127307288682051,-0.000132939641244928,-0.000138485227007704,-0.000143849685193144,-0.000149105930069186,-0.000154155123850489,-0.000159065497470520,-0.000163747562825094,-0.000168268842386729,-0.000172537732358560,-0.000176614657550197,-0.000180410108422542,-0.000183999618979702,-0.000187281168760834,-0.000190339671769101,-0.000193069129196545,-0.000195544832397821,-0.000197677788078587,-0.000199539649008486,-0.000201032940868009,-0.000202235729553226,-0.000203058654506368,-0.000203573986057050,-0.000203691067166756,-0.000203487773471098,-0.000202874988023436,-0.000201926312667679,-0.000200555959497587,-0.000198837675541615,-0.000196699431060807,-0.000194201255773334,-0.000191275046757538,-0.000187986578793287,-0.000184261773808270,-0.000180179587772206,-0.000175664814605442,-0.000170786560958344,-0.000165477236855775,-0.000159812221831987,-0.000153719685920933,-0.000147274624653123,-0.000140412733723718,-0.000133211641184504,-0.000125603948629548,-0.000117671106050587,-0.000109346031623928,-0.000100716848709064,-9.17098177136769e-05,-8.24135274350157e-05,-7.27675721790263e-05,-6.28524683586496e-05,-5.26154745139176e-05,-4.21360925784776e-05,-3.13561417949628e-05,-2.03628381158372e-05,-9.10548308408779e-06,2.33457234126265e-06,1.40083194094269e-05,2.58295177612030e-05,3.78461722061564e-05,4.99768369551838e-05,6.22643175964633e-05,7.46260531701306e-05,8.71015836332407e-05,9.96106640021813e-05,0.000112195182957433,0.000124763942574905,0.000137366791715695,0.000149911198748540,0.000162442650792396,0.000174872085811844,0.000187239257221613,0.000199451793564108,0.000211556366925701,0.000223462318933483,0.000235210142057933,0.000246708178586736,0.000258001679127413,0.000268997207097026,0.000279738531222084,0.000290134554911173,0.000300228099194048,0.000309932960487344,0.000319282655712915,0.000328197942179384,0.000336714906761676,0.000344749337750969,0.000352342214627579,0.000359409714548002,0.000365991134829042,0.000372009182773246,0.000377503151146030,0.000382391369532932,0.000386715355236634,0.000390400982280599,0.000393490139475396,0.000395907558926026,0.000397698804330678,0.000398788691631420,0.000399227555108601,0.000398936949491846,0.000397972126233778,0.000396261614975435,0.000393854800530148,0.000390686813600864,0.000386809444823400,0.000382158413194685,0.000376790304180755,0.000370643967863770,0.000363773911074794,0.000356124607855461,0.000347755900742044,0.000338613518931802,0.000328754366434312,0.000318131560210269,0.000306804217025510,0.000294730940570662,0.000281970783276626,0.000268485375892589,0.000254340452287311,0.000239494096399560,0.000224016969665576,0.000207873222878894,0.000191133273807514,0.000173765618136407,0.000155843780651501,0.000137336405786915,0.000118320880835366,9.87712107209166e-05,7.87649197446004e-05,5.82753501369848e-05,3.73869378124138e-05,1.60763381444399e-05,-5.57181367616681e-06,-2.75786271702548e-05,-4.98597333605973e-05,-7.24277527770317e-05,-9.52011421166725e-05,-0.000118189260376452,-0.000141305914994938,-0.000164562256917407,-0.000187871386991259,-0.000211240446658423,-0.000234583440222959,-0.000257904473544894,-0.000281114713754740,-0.000304219017751550,-0.000327130203950475,-0.000349848422387218,-0.000372285725407861,-0.000394444974187120,-0.000416236815989947,-0.000437664867735711,-0.000458635187853111,-0.000479154967235462,-0.000499132486368234,-0.000518571167331515,-0.000537383174254904,-0.000555572222029105,-0.000573048901167865,-0.000589819579725097,-0.000605796718602422,-0.000620986705872339,-0.000635305616463486,-0.000648761650903330,-0.000661270469727521,-0.000672840693410940,-0.000683394826357513,-0.000692941745122684,-0.000701407072869564,-0.000708800231576655,-0.000715052214556773,-0.000720177321535431,-0.000724104992307774,-0.000726854226726217,-0.000728358940404026,-0.000728639673514570,-0.000727635587782811,-0.000725371590866529,-0.000721789201263820,-0.000716917647289891,-0.000710703308261518,-0.000703178427293529,-0.000694293188732122,-0.000684088199776440,-0.000672515984110166,-0.000659619835012962,-0.000645357711331969,-0.000629777707641948,-0.000612845575342612,-0.000594609515551292,-0.000575041932649785,-0.000554197820740477,-0.000532052940816354,-0.000508666364674733,-0.000484020359483191,-0.000458176588681279,-0.000431123715427096,-0.000402929092662341,-0.000373585975859656,-0.000343165205716981,-0.000311667808991525,-0.000279166858443297,-0.000245666770951604,-0.000211247416105005,-0.000175917825106060,-0.000139763654925756,-0.000102794765555861,-6.51013581203412e-05,-2.67011263471968e-05,1.23144475577173e-05,5.19237728770901e-05,9.20301594233310e-05,0.000132609165300499,0.000173560572600170,0.000214855826121808,0.000256393372687194,0.000298141650880021,0.000339995157790542,0.000381919417118946,0.000423808884415285,0.000465623575722008,0.000507257568368754,0.000548668635828417,0.000589752050195621,0.000630462773188379,0.000670692057945732,0.000710396267952876,0.000749467474415613,0.000787859647202516,0.000825465518460331,0.000862239316769095,0.000898074071308576,0.000932924990635283,0.000966686293795938,0.000999313419396634,0.00103070216798669,0.00106081215739164,0.00108953885222047,0.00111684422272385,0.00114262731666238,0.00116685247531479,0.00118942175692229,0.00121030061817264,0.00122939796793344,0.00124668423278996,0.00126207020717782,0.00127552987306713,0.00128698052760138,0.00129640002173377,0.00130371145569906,0.00130889783895972,0.00131188783691264,0.00131266976907704,0.00131118060641549,0.00130741231050238,0.00130130852356199,0.00129286965017347,0.00128204532150596,0.00126884335665760,0.00125321921343951,0.00123518987974703,0.00121471920526834,0.00119182869091030,0.00116649056692474,0.00113873684808289,0.00110854701114259,0.00107596061262247,0.00104096524222402,0.00100360827653071,0.000963886029224727,0.000921855083364274,0.000877519478209494,0.000830943752865778,0.000782143009909452,0.000731188437409330,0.000678104128753062,0.000622968490075455,0.000565816029677253,0.000506733582309683,0.000445762018645188,0.000382996923854039,0.000318489797233966,0.000252342345515094,0.000184613276080216,0.000115412396559709,4.48072673582180e-05,-2.70848686906106e-05,-0.000100188988574231,-0.000174381313376744,-0.000249580707539433,-0.000325654846724977,-0.000402516924983970,-0.000480028923968466,-0.000558096985321620,-0.000636576935783656,-0.000715369142314445,-0.000794326439492581,-0.000873343173306266,-0.000952266288029154,-0.00103098658047587,-0.00110934863228086,-0.00118723734538173,-0.00126449384546381,-0.00134100040942582,-0.00141659670496191,-0.00149116169390987,-0.00156453434227106,-0.00163658954207848,-0.00170716677005253,-0.00177614075148516,-0.00184334983468972,-0.00190866881429133,-0.00197193668829600,-0.00203302967785819,-0.00209178741115426,-0.00214808599195844,-0.00220176887337595,-0.00225271584886230,-0.00230077146552979,-0.00234581873197445,-0.00238770724768884,-0.00242632395874298,-0.00246152232048013,-0.00249319423127249,-0.00252119831098582,-0.00254543298026339,-0.00256576423234902,-0.00258209503004848,-0.00259429903649452,-0.00260228600357247,-0.00260593852087824,-0.00260517338375871,-0.00259988121772397,-0.00258998870129861,-0.00257539642952963,-0.00255603795788727,-0.00253182433495764,-0.00250270009665247,-0.00246858705243215,-0.00242943931341139,-0.00238518996822143,-0.00233580472546744,-0.00228122778632175,-0.00222143681787360,-0.00215638653582386,-0.00208606713397257,-0.00201044642138564,-0.00192952738540964,-0.00184328966388219,-0.00175174840241639,-0.00165489719537485,-0.00155276402521117,-0.00144535447918267,-0.00133270985289676,-0.00121485059835089,-0.00109183041449224,-0.000963681954362080,-0.000830472175779342,-0.000692248286190477,-0.000549089129255830,-0.000401056198934444,-0.000248240193920176,-9.07162877487537e-05,7.14115686348857e-05,0.000238055886811034,0.000409100994530720,0.000584446509298580,0.000763963759787076,0.000947539862852404,0.00113503550829584,0.00132632614965820,0.00152125993623827,0.00171970235406790,0.00192149162483969,0.00212648155122262,0.00233449947976222,0.00254539014177775,0.00275897131591406,0.00297507872568506,0.00319352139085831,0.00341412557596511,0.00363669344455416,0.00386104302068235,0.00408696970407686,0.00431428367689800,0.00454277489499274,0.00477224831876250,0.00500248860183745,0.00523329379634916,0.00546444575462449,0.00569573827082559,0.00592694961939387,0.00615787000391560,0.00638827668505801,0.00661795767442196,0.00684668851335100,0.00707425589211545,0.00730043500467513,0.00752501314945028,0.00774776647433091,0.00796848355745167,0.00818694182458143,0.00840293254108574,0.00861623671067313,0.00882664790984789,0.00903395071495296,0.00923794388055003,0.00943841773424809,0.00963517537124467,0.00982801302829251,0.0100167404824621,0.0102011615585608,0.0103810920782832,0.0105563451380382,0.0107267445553228,0.0108921130492370,0.0110522831984579,0.0112070874938285,0.0113563677291752,0.0114999680878712,0.0116377413293624,0.0117695428775738,0.0118952367474150,0.0120146912562098,0.0121277831657279,0.0122343923766869,0.0123344086068315,0.0124277262463777,0.0125142487900573,0.0125938837865943,0.0126665495338989,0.0127321676744046,0.0127906711167099,0.0128419963854253,0.0128860909871240,0.0129229070773717,0.0129524073623039,0.0129745598429288,0.0129893415501913,0.0129967359058641,0.0129967359058641,0.0129893415501913,0.0129745598429288,0.0129524073623039,0.0129229070773717,0.0128860909871240,0.0128419963854253,0.0127906711167099,0.0127321676744046,0.0126665495338989,0.0125938837865943,0.0125142487900573,0.0124277262463777,0.0123344086068315,0.0122343923766869,0.0121277831657279,0.0120146912562098,0.0118952367474150,0.0117695428775738,0.0116377413293624,0.0114999680878712,0.0113563677291752,0.0112070874938285,0.0110522831984579,0.0108921130492370,0.0107267445553228,0.0105563451380382,0.0103810920782832,0.0102011615585608,0.0100167404824621,0.00982801302829251,0.00963517537124467,0.00943841773424809,0.00923794388055003,0.00903395071495296,0.00882664790984789,0.00861623671067313,0.00840293254108574,0.00818694182458143,0.00796848355745167,0.00774776647433091,0.00752501314945028,0.00730043500467513,0.00707425589211545,0.00684668851335100,0.00661795767442196,0.00638827668505801,0.00615787000391560,0.00592694961939387,0.00569573827082559,0.00546444575462449,0.00523329379634916,0.00500248860183745,0.00477224831876250,0.00454277489499274,0.00431428367689800,0.00408696970407686,0.00386104302068235,0.00363669344455416,0.00341412557596511,0.00319352139085831,0.00297507872568506,0.00275897131591406,0.00254539014177775,0.00233449947976222,0.00212648155122262,0.00192149162483969,0.00171970235406790,0.00152125993623827,0.00132632614965820,0.00113503550829584,0.000947539862852404,0.000763963759787076,0.000584446509298580,0.000409100994530720,0.000238055886811034,7.14115686348857e-05,-9.07162877487537e-05,-0.000248240193920176,-0.000401056198934444,-0.000549089129255830,-0.000692248286190477,-0.000830472175779342,-0.000963681954362080,-0.00109183041449224,-0.00121485059835089,-0.00133270985289676,-0.00144535447918267,-0.00155276402521117,-0.00165489719537485,-0.00175174840241639,-0.00184328966388219,-0.00192952738540964,-0.00201044642138564,-0.00208606713397257,-0.00215638653582386,-0.00222143681787360,-0.00228122778632175,-0.00233580472546744,-0.00238518996822143,-0.00242943931341139,-0.00246858705243215,-0.00250270009665247,-0.00253182433495764,-0.00255603795788727,-0.00257539642952963,-0.00258998870129861,-0.00259988121772397,-0.00260517338375871,-0.00260593852087824,-0.00260228600357247,-0.00259429903649452,-0.00258209503004848,-0.00256576423234902,-0.00254543298026339,-0.00252119831098582,-0.00249319423127249,-0.00246152232048013,-0.00242632395874298,-0.00238770724768884,-0.00234581873197445,-0.00230077146552979,-0.00225271584886230,-0.00220176887337595,-0.00214808599195844,-0.00209178741115426,-0.00203302967785819,-0.00197193668829600,-0.00190866881429133,-0.00184334983468972,-0.00177614075148516,-0.00170716677005253,-0.00163658954207848,-0.00156453434227106,-0.00149116169390987,-0.00141659670496191,-0.00134100040942582,-0.00126449384546381,-0.00118723734538173,-0.00110934863228086,-0.00103098658047587,-0.000952266288029154,-0.000873343173306266,-0.000794326439492581,-0.000715369142314445,-0.000636576935783656,-0.000558096985321620,-0.000480028923968466,-0.000402516924983970,-0.000325654846724977,-0.000249580707539433,-0.000174381313376744,-0.000100188988574231,-2.70848686906106e-05,4.48072673582180e-05,0.000115412396559709,0.000184613276080216,0.000252342345515094,0.000318489797233966,0.000382996923854039,0.000445762018645188,0.000506733582309683,0.000565816029677253,0.000622968490075455,0.000678104128753062,0.000731188437409330,0.000782143009909452,0.000830943752865778,0.000877519478209494,0.000921855083364274,0.000963886029224727,0.00100360827653071,0.00104096524222402,0.00107596061262247,0.00110854701114259,0.00113873684808289,0.00116649056692474,0.00119182869091030,0.00121471920526834,0.00123518987974703,0.00125321921343951,0.00126884335665760,0.00128204532150596,0.00129286965017347,0.00130130852356199,0.00130741231050238,0.00131118060641549,0.00131266976907704,0.00131188783691264,0.00130889783895972,0.00130371145569906,0.00129640002173377,0.00128698052760138,0.00127552987306713,0.00126207020717782,0.00124668423278996,0.00122939796793344,0.00121030061817264,0.00118942175692229,0.00116685247531479,0.00114262731666238,0.00111684422272385,0.00108953885222047,0.00106081215739164,0.00103070216798669,0.000999313419396634,0.000966686293795938,0.000932924990635283,0.000898074071308576,0.000862239316769095,0.000825465518460331,0.000787859647202516,0.000749467474415613,0.000710396267952876,0.000670692057945732,0.000630462773188379,0.000589752050195621,0.000548668635828417,0.000507257568368754,0.000465623575722008,0.000423808884415285,0.000381919417118946,0.000339995157790542,0.000298141650880021,0.000256393372687194,0.000214855826121808,0.000173560572600170,0.000132609165300499,9.20301594233310e-05,5.19237728770901e-05,1.23144475577173e-05,-2.67011263471968e-05,-6.51013581203412e-05,-0.000102794765555861,-0.000139763654925756,-0.000175917825106060,-0.000211247416105005,-0.000245666770951604,-0.000279166858443297,-0.000311667808991525,-0.000343165205716981,-0.000373585975859656,-0.000402929092662341,-0.000431123715427096,-0.000458176588681279,-0.000484020359483191,-0.000508666364674733,-0.000532052940816354,-0.000554197820740477,-0.000575041932649785,-0.000594609515551292,-0.000612845575342612,-0.000629777707641948,-0.000645357711331969,-0.000659619835012962,-0.000672515984110166,-0.000684088199776440,-0.000694293188732122,-0.000703178427293529,-0.000710703308261518,-0.000716917647289891,-0.000721789201263820,-0.000725371590866529,-0.000727635587782811,-0.000728639673514570,-0.000728358940404026,-0.000726854226726217,-0.000724104992307774,-0.000720177321535431,-0.000715052214556773,-0.000708800231576655,-0.000701407072869564,-0.000692941745122684,-0.000683394826357513,-0.000672840693410940,-0.000661270469727521,-0.000648761650903330,-0.000635305616463486,-0.000620986705872339,-0.000605796718602422,-0.000589819579725097,-0.000573048901167865,-0.000555572222029105,-0.000537383174254904,-0.000518571167331515,-0.000499132486368234,-0.000479154967235462,-0.000458635187853111,-0.000437664867735711,-0.000416236815989947,-0.000394444974187120,-0.000372285725407861,-0.000349848422387218,-0.000327130203950475,-0.000304219017751550,-0.000281114713754740,-0.000257904473544894,-0.000234583440222959,-0.000211240446658423,-0.000187871386991259,-0.000164562256917407,-0.000141305914994938,-0.000118189260376452,-9.52011421166725e-05,-7.24277527770317e-05,-4.98597333605973e-05,-2.75786271702548e-05,-5.57181367616681e-06,1.60763381444399e-05,3.73869378124138e-05,5.82753501369848e-05,7.87649197446004e-05,9.87712107209166e-05,0.000118320880835366,0.000137336405786915,0.000155843780651501,0.000173765618136407,0.000191133273807514,0.000207873222878894,0.000224016969665576,0.000239494096399560,0.000254340452287311,0.000268485375892589,0.000281970783276626,0.000294730940570662,0.000306804217025510,0.000318131560210269,0.000328754366434312,0.000338613518931802,0.000347755900742044,0.000356124607855461,0.000363773911074794,0.000370643967863770,0.000376790304180755,0.000382158413194685,0.000386809444823400,0.000390686813600864,0.000393854800530148,0.000396261614975435,0.000397972126233778,0.000398936949491846,0.000399227555108601,0.000398788691631420,0.000397698804330678,0.000395907558926026,0.000393490139475396,0.000390400982280599,0.000386715355236634,0.000382391369532932,0.000377503151146030,0.000372009182773246,0.000365991134829042,0.000359409714548002,0.000352342214627579,0.000344749337750969,0.000336714906761676,0.000328197942179384,0.000319282655712915,0.000309932960487344,0.000300228099194048,0.000290134554911173,0.000279738531222084,0.000268997207097026,0.000258001679127413,0.000246708178586736,0.000235210142057933,0.000223462318933483,0.000211556366925701,0.000199451793564108,0.000187239257221613,0.000174872085811844,0.000162442650792396,0.000149911198748540,0.000137366791715695,0.000124763942574905,0.000112195182957433,9.96106640021813e-05,8.71015836332407e-05,7.46260531701306e-05,6.22643175964633e-05,4.99768369551838e-05,3.78461722061564e-05,2.58295177612030e-05,1.40083194094269e-05,2.33457234126265e-06,-9.10548308408779e-06,-2.03628381158372e-05,-3.13561417949628e-05,-4.21360925784776e-05,-5.26154745139176e-05,-6.28524683586496e-05,-7.27675721790263e-05,-8.24135274350157e-05,-9.17098177136769e-05,-0.000100716848709064,-0.000109346031623928,-0.000117671106050587,-0.000125603948629548,-0.000133211641184504,-0.000140412733723718,-0.000147274624653123,-0.000153719685920933,-0.000159812221831987,-0.000165477236855775,-0.000170786560958344,-0.000175664814605442,-0.000180179587772206,-0.000184261773808270,-0.000187986578793287,-0.000191275046757538,-0.000194201255773334,-0.000196699431060807,-0.000198837675541615,-0.000200555959497587,-0.000201926312667679,-0.000202874988023436,-0.000203487773471098,-0.000203691067166756,-0.000203573986057050,-0.000203058654506368,-0.000202235729553226,-0.000201032940868009,-0.000199539649008486,-0.000197677788078587,-0.000195544832397821,-0.000193069129196545,-0.000190339671769101,-0.000187281168760834,-0.000183999618979702,-0.000180410108422542,-0.000176614657550197,-0.000172537732358560,-0.000168268842386729,-0.000163747562825094,-0.000159065497470520,-0.000154155123850489,-0.000149105930069186,-0.000143849685193144,-0.000138485227007704,-0.000132939641244928,-0.000127307288682051,-0.000121519272343622,-0.000115676372372865,-0.000109697997071951,-0.000103682012991266,-9.75654670895193e-05,-9.14401945504774e-05,-8.52279610848206e-05,-7.90410980914675e-05,-7.27858565630876e-05,-6.65825658764451e-05,-6.03383815347067e-05,-5.41595901893067e-05,-4.79583368280765e-05,-4.18455036996932e-05,-3.57404177106019e-05,-2.97453242813735e-05,-2.37704834556051e-05,-1.79228936593184e-05,-1.21198044431343e-05,-6.45841102863223e-06,-8.51656796130459e-07,4.58495136195912e-06,9.94502532257170e-06,1.51374698983752e-05,2.02281483366621e-05,2.51364658156456e-05,2.99340432126425e-05,3.45293165485052e-05,3.90144660773525e-05,4.32856275209139e-05,4.74341579936882e-05,5.13562501502233e-05,5.51551200316416e-05,5.87297128765240e-05,6.21711020078835e-05,6.53686049825955e-05,6.84296901578563e-05,7.12524932888259e-05,7.39303409232333e-05,7.63625048014221e-05,7.86724446681090e-05,8.07231101667877e-05,8.26398743691200e-05,8.43112766407217e-05,8.58406272224750e-05,8.71370485888772e-05,8.82916271297840e-05,8.92100837125149e-05,8.99922030391493e-05,9.05494677793848e-05,9.09809718682166e-05,9.11831839420458e-05,9.12564806176701e-05,9.11176091960672e-05,9.08729604982330e-05,9.04134830877461e-05,8.98407434422261e-05,8.90830665279796e-05,8.82155315002777e-05,8.71546944405953e-05,8.60297099343899e-05,8.47115036484625e-05,8.33397368232544e-05,8.17790082944034e-05,8.01631440421784e-05,7.83750628099677e-05,7.65507052026812e-05,7.45674954007085e-05,7.25511529784107e-05,7.03858633206040e-05,6.82171350429117e-05,6.59220003793916e-05,6.36162650168458e-05,6.11757983263581e-05,5.87692470064259e-05,5.62469136642102e-05,5.37327605371150e-05,5.11520557343697e-05,4.85746624036225e-05,4.59225791208800e-05,4.33012064262814e-05,4.06115404030407e-05,3.79816107130622e-05,3.52903596441715e-05,3.26568723594888e-05,2.99542649311928e-05,2.73250687867486e-05,2.46574527886935e-05,2.20837053049331e-05,1.94572385780843e-05,1.69250740323752e-05,1.43887846917702e-05,1.19677705208975e-05,9.46943965838447e-06,7.13865499159586e-06,4.74371681025143e-06,2.48939253003056e-06,2.23960834993262e-07,-1.90305074656828e-06,-4.03228598087500e-06,-6.03001997275351e-06,-8.03535017709244e-06,-9.89831269055974e-06,-1.17446328046574e-05,-1.34348151496517e-05,-1.51292639740536e-05,-1.67118087215978e-05,-1.82974039525518e-05,-1.97118097525056e-05,-2.10994881718715e-05,-2.24266664881490e-05,-2.36553239376072e-05,-2.47539731073938e-05,-2.58660253703977e-05,-2.67924023081827e-05,-2.77571004008799e-05,-2.85458855825865e-05,-2.93565158682240e-05,-2.99747646936382e-05,-3.05948202970010e-05,-3.10247447096997e-05,-3.14934240378381e-05,-3.18208393945121e-05,-3.22161589098308e-05,-3.24192630895979e-05,-3.26285630419364e-05,-3.26531473451666e-05,-3.28977575438944e-05,-3.28616540537839e-05,-3.28102810915339e-05,-3.27575807815398e-05,-3.25851098683830e-05,-3.23706381287010e-05,-3.21141968935246e-05,-3.18066997073650e-05,-3.15111384850524e-05,-3.11967600503739e-05,-3.09208215243265e-05,-3.06257870229791e-05,-3.03194861182596e-05,-2.99368114356206e-05,-2.94726793379448e-05,-2.90063996178404e-05,-2.86244650050044e-05,-2.86210968408115e-05,-2.84292656714884e-05,-2.76963035394188e-05,-2.79542660979663e-05,-2.76167617103940e-05,-2.77276100019451e-05,-2.76812923161268e-05,-2.79559318273690e-05,-2.81680961031351e-05,-2.87014631601664e-05,-2.92364739015668e-05,-3.01204898794731e-05,-3.10681776493996e-05,-3.24107450011364e-05,-3.38858849806385e-05,-3.58188158280655e-05,-3.79654554769724e-05,-4.06525714850800e-05,-4.36517792826240e-05,0.000267238437462116];
%生成的滤波系数
out =conv(y,coeff);%卷积

% draw waveform
figure(1);
subplot(2,2,1);
plot(y);
xlabel('滤波前');
axis([0 200 -6 6]);%调整横纵比
subplot(2,2,2);
plot(out);
xlabel('滤波后');
axis([0 200 -4 4]);

%频谱图
%figure(2);
df = Fs / ( len - 1 );
f = ( 0 : len ) * df;
Y1 = fft(y);
subplot(2,2,3);
plot(f(1:len/2),abs(Y1(1:len/2)),'r','LineWidth',1.2);
set(gca,'LineWidth',1.2);

Y2 = fft(out);
subplot(2,2,4);
plot(f(1:len/2),abs(Y2(1:len/2)),'r','LineWidth',1.2);
axis([0 6*10^6 0 600]);
set(gca,'LineWidth',1.2);



